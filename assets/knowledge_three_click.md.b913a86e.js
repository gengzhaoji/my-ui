import{_ as s,c as n,o as a,a as l}from"./app.ba09d780.js";var p="/my-ui/coordinate.png",o="/my-ui/Raycaster.png";const h=JSON.parse('{"title":"Three \u6A21\u578B\u4EA4\u4E92","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u5750\u6807\u7CFB","slug":"\u5750\u6807\u7CFB"},{"level":2,"title":"Raycaster","slug":"raycaster"},{"level":2,"title":"\u627E\u5230\u70B9\u51FB\u7269\u4F53\u7684\u5927\u81F4\u601D\u8DEF","slug":"\u627E\u5230\u70B9\u51FB\u7269\u4F53\u7684\u5927\u81F4\u601D\u8DEF"},{"level":3,"title":"\u521D\u59CB\u5199\u6CD5","slug":"\u521D\u59CB\u5199\u6CD5"},{"level":3,"title":"\u6539\u8FDB\u5199\u6CD5","slug":"\u6539\u8FDB\u5199\u6CD5"}],"relativePath":"knowledge/three/click.md","lastUpdated":1690968742000}'),e={name:"knowledge/three/click.md"},t=l('<h1 id="three-\u6A21\u578B\u4EA4\u4E92" tabindex="-1">Three \u6A21\u578B\u4EA4\u4E92 <a class="header-anchor" href="#three-\u6A21\u578B\u4EA4\u4E92" aria-hidden="true">#</a></h1><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>\u5E38\u89C1\u7684\u4EA4\u4E92\u65B9\u5F0F<strong>\u70B9\u51FB</strong></p></div><h2 id="\u5750\u6807\u7CFB" tabindex="-1">\u5750\u6807\u7CFB <a class="header-anchor" href="#\u5750\u6807\u7CFB" aria-hidden="true">#</a></h2><p>\u6211\u4EEC\u7684\u624B\u673A\u5C4F\u5E55\u662F\u4E8C\u7EF4\u7684\uFF0C\u4F46\u662F\u6211\u4EEC\u5C55\u793A\u7269\u4F53\u7684\u4E16\u754C\u662F\u4E09\u7EF4\u7684\uFF0C\u5F53\u6211\u4EEC\u5728\u6784\u5EFA\u4E00\u4E2A\u7269\u4F53\u7684\u65F6\u5019\u6211\u4EEC\u662F\u4EE5\u4E00\u4E2A\u4E09\u7EF4\u4E16\u754C\u65E2\u662F\u4E16\u754C\u5750\u6807\u6765\u6784\u5EFA\uFF0C\u800C\u8F6C\u5316\u4E3A\u5C4F\u5E55\u5750\u6807\u5C55\u793A\u5728\u6211\u4EEC\u773C\u524D\uFF0C\u5219\u9700\u8981\u7ECF\u5386\u591A\u9053\u77E9\u9635\u53D8\u5316\uFF0C\u4E2D\u95F4 webGL \u66FF\u6211\u4EEC\u64CD\u4F5C\u4E86\u8BB8\u591A\u4E8B\u60C5\u3002</p><img src="'+p+`"><ul><li><strong>\u4E16\u754C\u5750\u6807\u7CFB\uFF1A</strong></li></ul><p>\u5728 webGL \u4E2D\uFF0C\u4E16\u754C\u5750\u6807\u7CFB\u662F\u4EE5\u5C4F\u5E55\u4E2D\u5FC3\u4E3A\u539F\u70B9(0, 0, 0)\uFF0C\u4E14\u662F\u59CB\u7EC8\u4E0D\u53D8\u7684\u3002\u4F60\u9762\u5BF9\u5C4F\u5E55\uFF0C\u4F60\u7684\u53F3\u8FB9\u662F x \u6B63\u8F74\uFF0C\u4E0A\u9762\u662F y \u6B63\u8F74\uFF0C\u5C4F\u5E55\u6307\u5411\u4F60\u7684\u4E3A z \u6B63\u8F74\u3002\u957F\u5EA6\u5355\u4F4D\u8FD9\u6837\u6765\u5B9A\uFF1A\u7A97\u53E3\u8303\u56F4\u6309\u6B64\u5355\u4F4D\u6070\u597D\u662F(-1,-1)\u5230(1,1)\uFF0C\u5373\u5C4F\u5E55\u5DE6\u4E0B\u89D2\u5750\u6807\u4E3A\uFF08-1\uFF0C-1\uFF09\uFF0C\u53F3\u4E0A\u89D2 \u5750\u6807\u4E3A\uFF081,1\uFF09\u3002</p><ul><li><strong>\u5C4F\u5E55\u5750\u6807\u7CFB\uFF1A</strong></li></ul><p>webGL \u7684\u91CD\u8981\u529F\u80FD\u4E4B\u4E00\u5C31\u662F\u5C06\u4E09\u7EF4\u7684\u4E16\u754C\u5750\u6807\u7ECF\u8FC7\u53D8\u6362\u3001\u6295\u5F71\u7B49\u8BA1\u7B97\uFF0C\u6700\u7EC8\u7B97\u51FA\u5B83\u5728\u663E\u793A\u8BBE\u5907\u4E0A\u5BF9\u5E94\u7684\u4F4D\u7F6E\uFF0C\u8FD9\u4E2A\u4F4D\u7F6E\u5C31\u79F0\u4E3A\u8BBE\u5907\u5750\u6807\u3002\u5728\u5C4F\u5E55\u3001\u6253\u5370\u673A\u7B49\u8BBE\u5907\u4E0A\u7684\u5750\u6807\u662F\u4E8C\u7EF4\u5750\u6807\u3002</p><ul><li><strong>\u89C6\u70B9\u5750\u6807\u7CFB\uFF1A</strong></li></ul><p>\u662F\u4EE5\u89C6\u70B9\uFF08\u7167\u76F8\u673A\uFF09\u4E3A\u539F\u70B9\uFF0C\u4EE5\u89C6\u7EBF\u7684\u65B9\u5411\u4E3A Z+\u8F74\u6B63\u65B9\u5411\u7684\u5750\u6807\u7CFB\u4E2D\u7684\u65B9\u5411\u3002webGL \u4F1A\u5C06\u4E16\u754C\u5750\u6807\u5148\u53D8\u6362\u5230\u89C6\u70B9\u5750\u6807\uFF0C\u7136\u540E\u8FDB\u884C\u88C1\u526A\uFF0C\u53EA\u6709\u5728\u89C6\u7EBF\u8303\u56F4(\u89C6\u89C1\u4F53)\u4E4B\u5185\u7684\u573A\u666F\u624D\u4F1A\u8FDB\u5165\u4E0B\u4E00\u9636\u6BB5\u7684\u8BA1\u7B97\u3002</p><h2 id="raycaster" tabindex="-1"><a href="https://threejs.org/docs/index.html?q=Raycaster#api/zh/core/Raycaster" target="_blank" rel="noopener noreferrer">Raycaster</a> <a class="header-anchor" href="#raycaster" aria-hidden="true">#</a></h2><p>\u8FD9\u4E2A\u7C7B\u8BBE\u8BA1\u7528\u4E8E\u9F20\u6807\u53BB\u83B7\u53D6\u5728 3D \u4E16\u754C\u88AB\u9F20\u6807\u9009\u4E2D\u7684\u4E00\u4E9B\u7269\u4F53</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#82AAFF;">Raycaster</span><span style="color:#A6ACCD;">( origin</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> direction</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> near</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> far )</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">origin \u2014 \u5C04\u7EBF\u7684\u8D77\u70B9\u5411\u91CF\u3002</span></span>
<span class="line"><span style="color:#A6ACCD;">direction \u2014 \u5C04\u7EBF\u7684\u65B9\u5411\u5411\u91CF\uFF0C\u5E94\u8BE5\u5F52\u4E00\u6807\u51C6\u5316\u3002</span></span>
<span class="line"><span style="color:#A6ACCD;">near \u2014 \u6240\u6709\u8FD4\u56DE\u7684\u7ED3\u679C\u5E94\u8BE5\u6BD4 near \u8FDC\u3002Near\u4E0D\u80FD\u4E3A\u8D1F\uFF0C\u9ED8\u8BA4\u503C\u4E3A0\u3002</span></span>
<span class="line"><span style="color:#A6ACCD;">far \u2014 \u6240\u6709\u8FD4\u56DE\u7684\u7ED3\u679C\u5E94\u8BE5\u6BD4 far \u8FD1\u3002Far \u4E0D\u80FD\u5C0F\u4E8E near\uFF0C\u9ED8\u8BA4\u503C\u4E3A\u65E0\u7A77\u5927\u3002</span></span>
<span class="line"></span></code></pre></div><h2 id="\u627E\u5230\u70B9\u51FB\u7269\u4F53\u7684\u5927\u81F4\u601D\u8DEF" tabindex="-1">\u627E\u5230\u70B9\u51FB\u7269\u4F53\u7684\u5927\u81F4\u601D\u8DEF <a class="header-anchor" href="#\u627E\u5230\u70B9\u51FB\u7269\u4F53\u7684\u5927\u81F4\u601D\u8DEF" aria-hidden="true">#</a></h2><img src="`+o+`"><div class="tip custom-block"><p class="custom-block-title">TIP</p><p><strong>\u539F\u7406\uFF1A</strong> \u9F20\u6807\u5728\u5C4F\u5E55\u4E0A\u70B9\u51FB\u7684\u65F6\u5019\uFF0C\u5F97\u5230\u4E8C\u7EF4\u5750\u6807 <code>p(x, y)</code>,\u518D\u52A0\u4E0A\u6DF1\u5EA6\u5750\u6807\u7684\u8303\u56F4<code>(0, 1)</code>, \u5C31\u53EF\u4EE5\u5F62\u6210\u4E24\u4E2A\u4E09\u4F4D\u5750\u6807 <code>A(x1, y1, 0)</code>, <code>B(x2, y, 1)</code>, \u7531\u4E8E\u5B83\u4EEC\u7684 <code>Z</code> \u8F74\u5750\u6807\u662F <code>0</code> \u548C <code>1</code>\uFF0C\u5219\u8F6C\u53D8\u5230\u6295\u5F71\u5750\u6807\u7CFB\u7684\u8BDD\uFF0C\u4E00\u5B9A\u5206\u522B\u662F\u524D\u526A\u5207\u5E73\u9762\u4E0A\u7684\u70B9\u548C\u540E\u526A\u5207\u5E73\u9762\u4E0A\u7684\u70B9\uFF0C\u4E5F\u5C31\u662F\u8BF4\uFF0C\u5728\u6295\u5F71\u5750\u6807\u7CFB\u4E2D\uFF0C<code>A</code> \u70B9\u4E00\u5B9A\u5728\u80FD\u770B\u89C1\u7684\u6240\u6709\u6A21\u578B\u7684\u6700\u524D\u9762\uFF0C<code>B</code> \u70B9\u4E00\u5B9A\u5728\u80FD\u770B\u89C1\u7684\u6240\u6709\u7684\u6A21\u578B\u7684\u6700\u540E\u8FB9\uFF0C\u5C06 <code>AB</code> \u70B9\u8FDE\u6210\u7EBF\uFF0C<code>AB</code> \u7EBF\u7A7F\u8FC7\u7684\u7269\u4F53\u5C31\u662F\u88AB\u70B9\u51FB\u7684\u7269\u4F53\u3002\u800C <code>Three.js</code> \u63D0\u4F9B\u4E00\u4E2A\u5C04\u7EBF\u7C7B <code>Raycasting</code> \u6765\u62FE\u53D6\u573A\u666F\u91CC\u9762\u7684\u7269\u4F53\u3002\u66F4\u65B9\u4FBF\u7684\u4F7F\u7528\u9F20\u6807\u6765\u64CD\u4F5C <code>3D</code> \u573A\u666F\u3002\uFF08\u4E0D\u8FC7\u5728\u5B9E\u9645\u4EE3\u7801\u4E2D\u6211\u4EEC\u7EC4\u6210\u5C04\u7EBF\u7684\u4E24\u4E2A\u70B9\u662F\u6444\u50CF\u673A\u6240\u5728\u89C6\u70B9\u4E0E\u5C4F\u5E55\u4E0A\u70B9\u51FB\u7684\u70B9\u8FDE\u63A5\u800C\u6210\u7684\u5C04\u7EBF\uFF09\u3002</p></div><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">// \u70B9\u51FB\u4E8B\u4EF6</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> rayCaster </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> THREE</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Raycaster</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    mouse </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> THREE</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Vector2</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//\u901A\u8FC7\u5C04\u7EBF\u4E0E\u5BF9\u8C61\u76F8\u4EA4\u6765\u83B7\u53D6\u5BF9\u8C61</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">getIntersects</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">preventDefault</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// \u901A\u8FC7\u9F20\u6807\u70B9\u51FB\u4F4D\u7F6E,\u8BA1\u7B97\u51FA raycaster \u6240\u9700\u70B9\u7684\u4F4D\u7F6E,\u4EE5\u5C4F\u5E55\u4E3A\u4E2D\u5FC3\u70B9,\u8303\u56F4 -1 \u5230 1</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//\u8FD9\u91CC\u7684container\u5C31\u662F\u753B\u5E03\u6240\u5728\u7684div\uFF0C\u4E5F\u5C31\u662F\u8BF4\uFF0C\u8FD9\u4E2A\u662F\u8981\u62FF\u6574\u4E2Ascene\u6240\u5728\u7684\u5BB9\u5668\u6765\u754C\u5B9A\u7684</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">left</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">top</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">width</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">height</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getBoundingClientRect</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">mouse</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> ((</span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">clientX</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">left</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">/</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">width</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">*</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">2</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">mouse</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">y</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;">((</span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">clientY</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">top</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">/</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">height</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">*</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">2</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//\u901A\u8FC7\u9F20\u6807\u70B9\u51FB\u7684\u4F4D\u7F6E(\u4E8C\u7EF4\u5750\u6807)\u548C\u5F53\u524D\u76F8\u673A\u7684\u77E9\u9635\u8BA1\u7B97\u51FA\u5C04\u7EBF\u4F4D\u7F6E</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">raycaster</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setFromCamera</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">mouse</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">camera</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// \u83B7\u53D6objects\u4E0E\u5C04\u7EBF\u76F8\u4EA4\u7684\u5BF9\u8C61\u6570\u7EC4\uFF0C\u5176\u4E2D\u7684\u5143\u7D20\u6309\u7167\u8DDD\u79BB\u6392\u5E8F\uFF0C\u8D8A\u8FD1\u7684\u8D8A\u9760\u524D\uFF0C</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">intersects</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">raycaster</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">intersectObjects</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">objects</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//\u8FD4\u56DE\u9009\u4E2D\u7684\u5BF9\u8C61\u6570\u7EC4</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">intersects</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">mouse</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">x </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> (e</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">clientX </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;"> window</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">innerWidth) </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">mouse</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">y </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">(e</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">clientY </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;"> window</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">innerHeight) </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p><strong>\u5C06\u9F20\u6807\u70B9\u51FB\u4F4D\u7F6E\u7684\u5C4F\u5E55\u5750\u6807\u8F6C\u6210 threejs \u4E2D\u7684\u6807\u51C6\u5750\u6807, \u63A8\u5BFC\u8FC7\u7A0B\uFF1A</strong></p><p>\u8BBE A \u70B9\u4E3A\u70B9\u51FB\u70B9(x1,y1),x1=e.clintX, y1=e.clientY</p><p>\u8BBE A \u70B9\u5728\u4E16\u754C\u5750\u6807\u4E2D\u7684\u5750\u6807\u503C\u4E3A B(x2,y2);</p><p>\u7531\u4E8E A \u70B9\u7684\u5750\u6807\u503C\u7684\u539F\u70B9\u662F\u4EE5\u5C4F\u5E55\u5DE6\u4E0A\u89D2\u4E3A(0,0);</p><p>\u6211\u4EEC\u53EF\u4EE5\u8BA1\u7B97\u53EF\u5F97\u4EE5\u5C4F\u5E55\u4E2D\u5FC3\u4E3A\u539F\u70B9\u7684 B&#39;\u503C</p><p>x2&#39; = x1 - innerWidth/2</p><p>y2&#39; = innerHeight/2 - y1</p><p>\u53C8\u7531\u4E8E\u5728\u4E16\u754C\u5750\u6807\u7684\u8303\u56F4\u662F[-1,1],\u8981\u5F97\u5230\u6B63\u786E\u7684 B \u503C\u6211\u4EEC\u5FC5\u987B\u8981\u5C06\u5750\u6807\u6807\u51C6\u5316</p><p>x2 = (x1 -innerWidth/2)/(innerwidth/2) = (x1/innerWidth)*2-1</p><p>\u540C\u7406\u5F97 y2 = -(y1/innerHeight)*2 +1</p></div><h3 id="\u521D\u59CB\u5199\u6CD5" tabindex="-1">\u521D\u59CB\u5199\u6CD5 <a class="header-anchor" href="#\u521D\u59CB\u5199\u6CD5" aria-hidden="true">#</a></h3><p>\u64CD\u4F5C\u7684\u662F\u6574\u4E2A\u754C\u9762\u7684\u65F6\u5019</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> rayCaster </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> THREE</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Raycaster</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    mouse </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> THREE</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Vector2</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//\u901A\u8FC7\u5C04\u7EBF\u4E0E\u5BF9\u8C61\u76F8\u4EA4\u6765\u83B7\u53D6\u5BF9\u8C61</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">getIntersects</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">preventDefault</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// \u901A\u8FC7\u9F20\u6807\u70B9\u51FB\u4F4D\u7F6E,\u8BA1\u7B97\u51FA raycaster \u6240\u9700\u70B9\u7684\u4F4D\u7F6E,\u4EE5\u5C4F\u5E55\u4E3A\u4E2D\u5FC3\u70B9,\u8303\u56F4 -1 \u5230 1</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">mouse</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">clientX</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">/</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">innerWidth</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">*</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">2</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">mouse</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">y</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">clientY</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">/</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">innerHeight</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">*</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">2</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//\u901A\u8FC7\u9F20\u6807\u70B9\u51FB\u7684\u4F4D\u7F6E(\u4E8C\u7EF4\u5750\u6807)\u548C\u5F53\u524D\u76F8\u673A\u7684\u77E9\u9635\u8BA1\u7B97\u51FA\u5C04\u7EBF\u4F4D\u7F6E</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">raycaster</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setFromCamera</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">mouse</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">camera</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//\u8FD9\u91CC\u7684objects\u662F\u4E00\u4E2A\u5BF9\u8C61\u6570\u7EC4</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// \u83B7\u53D6objects\u4E0E\u5C04\u7EBF\u76F8\u4EA4\u7684\u5BF9\u8C61\u6570\u7EC4\uFF0C\u5176\u4E2D\u7684\u5143\u7D20\u6309\u7167\u8DDD\u79BB\u6392\u5E8F\uFF0C\u8D8A\u8FD1\u7684\u8D8A\u9760\u524D\uFF0C</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">intersects</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">raycaster</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">intersectObjects</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">objects</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//\u8FD4\u56DE\u9009\u4E2D\u7684\u5BF9\u8C61\u6570\u7EC4</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">intersects</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h3 id="\u6539\u8FDB\u5199\u6CD5" tabindex="-1">\u6539\u8FDB\u5199\u6CD5 <a class="header-anchor" href="#\u6539\u8FDB\u5199\u6CD5" aria-hidden="true">#</a></h3><p>\u4F46\u662F\u5982\u679C<code>canvas</code>\u7684\u5927\u5C0F\u5E76\u4E0D\u662F\u6574\u4E2A\u754C\u9762\u7684\u5927\u5C0F\uFF08\u6BD4\u5982\u6709\u5176\u4ED6\u7684<code>div</code>\uFF0C\u800C<code>canvas</code>\u53EA\u662F\u5D4C\u5165\u5176\u4E2D\uFF09\uFF0C\u90A3\u4E48\u6309\u7167\u521D\u59CB\u5199\u6CD5\u5C31\u4F1A\u83B7\u53D6\u4E0D\u5230\u7269\u4F53\u3002</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> rayCaster </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> THREE</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Raycaster</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    mouse </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> THREE</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Vector2</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//\u901A\u8FC7\u5C04\u7EBF\u4E0E\u5BF9\u8C61\u76F8\u4EA4\u6765\u83B7\u53D6\u5BF9\u8C61</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">getIntersects</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">preventDefault</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// \u901A\u8FC7\u9F20\u6807\u70B9\u51FB\u4F4D\u7F6E,\u8BA1\u7B97\u51FA raycaster \u6240\u9700\u70B9\u7684\u4F4D\u7F6E,\u4EE5\u5C4F\u5E55\u4E3A\u4E2D\u5FC3\u70B9,\u8303\u56F4 -1 \u5230 1</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//\u8FD9\u91CC\u7684container\u5C31\u662F\u753B\u5E03\u6240\u5728\u7684div\uFF0C\u4E5F\u5C31\u662F\u8BF4\uFF0C\u8FD9\u4E2A\u662F\u8981\u62FF\u6574\u4E2Ascene\u6240\u5728\u7684\u5BB9\u5668\u6765\u754C\u5B9A\u7684</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">left</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">top</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">width</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">height</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">container</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getBoundingClientRect</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">mouse</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> ((</span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">clientX</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">left</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">/</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">width</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">*</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">2</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">mouse</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">y</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;">((</span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">clientY</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">top</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">/</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">height</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">*</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">2</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//\u901A\u8FC7\u9F20\u6807\u70B9\u51FB\u7684\u4F4D\u7F6E(\u4E8C\u7EF4\u5750\u6807)\u548C\u5F53\u524D\u76F8\u673A\u7684\u77E9\u9635\u8BA1\u7B97\u51FA\u5C04\u7EBF\u4F4D\u7F6E</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">raycaster</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setFromCamera</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">mouse</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">camera</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// \u83B7\u53D6objects\u4E0E\u5C04\u7EBF\u76F8\u4EA4\u7684\u5BF9\u8C61\u6570\u7EC4\uFF0C\u5176\u4E2D\u7684\u5143\u7D20\u6309\u7167\u8DDD\u79BB\u6392\u5E8F\uFF0C\u8D8A\u8FD1\u7684\u8D8A\u9760\u524D\uFF0C</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">intersects</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">raycaster</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">intersectObjects</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">objects</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//\u8FD4\u56DE\u9009\u4E2D\u7684\u5BF9\u8C61\u6570\u7EC4</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">intersects</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div>`,25),c=[t];function r(y,F,D,A,C,i){return a(),n("div",null,c)}var u=s(e,[["render",r]]);export{h as __pageData,u as default};
